# Лекция 5

Преимущества реляционной модели: сохранение целостности данных

## Базис реляционной алгебры

1) Ввести объект

2) Определить операции

3) Законы

### Объект

Объект - отношение (таблица, которая часто сопоставляется с сущностью, содержит атрибуты, столбцы, записи)

#### Унарные:

    1) Проекция
    2) Выборка
    3) Объединение
    4) Разность
    5) Пересечение
    6) Декартово произведение
    7) Тета-соединение
    8) Естественное соединение
    9) Левое внешнее соединение
    10) Полусоединение

_Проекция_ (**П** a1, a2 ....  an (R)) - операция, которая определяет новое отношение содержащие вертикальное подмножество исходного отношения, создаваемое посредством извлечения значений указанных атрибутов и исключения из результата строк дубликатов

_Выборка_ (**σ** (R)) - операция, которая определяет результирующее отношение, которое содержит только те кортежи из исходного отношения, которые удовлетворяют заданному условию (предикату)

_Объединение_ (**R ∪ S**) - объедение двух отношений R и S определяет новое отношение,которое включает все кортежи содержащеися только в R, только в S и кортежи содержащеися и в R и в S с исключением дубликатов

1) _Совместимость по объедению_ - два отношения R и S будут совместимы если они состоят из одинакового количества атрибутов и каждая пара атрибутов будет иметь одинаковый домен

_Разность_ - (**R - S**) - разности двух отношений R - S называется отношением, которое будет содержать кортежи которые есть в R но нет в отношении S. Разность требует чтобы отношение было совместимо по объединению

_Пересечение_ - (**R ∩ S**) - пересечение двух отношений R - S называется отношением, которое будет содержать кортежи которые есть в R и в S. Пересечение требует чтобы отношение было совместимо по объединению

_Декартово произведение_ - (**R x S**) - определяет новое отношение, которое является результатом конкатенации каждого кортежа из отношения R с каждым кортежем из отношения S

_Тета-соединение_ - ( R **|><| f** S ) (**JOIN ON**) - определяет новое отношение, которое содержит кортежи из декартового произведения отношений R и S, удовлетворяющее предикату F. Если тета в предикате - =, то такое соединение называется **экви-соединение**

_Естественное соединение_ - ( R **|><|** S ) - соединение по эквивалентности двух отношений, выполненная по всем общим атрибутам из результата которого, исключается по одному из результатов общего атрибута

_Левое внешнее соединение_ - (R S) - тета-соединение, при котором в результирующее отношение включаются также кортежи отношения R немеющие совпадающие значения в общих столбцах отношения S

_Полусоединение_ - кортежи из R, которые входят в объединения R и S

### Как развернуть SELECT/FROM/WHERE и т.д?

```sql

SELECT [DISTINCT | ALL] 
{* | [ColumnExpression [As "NewName"]], [...], [...]}

FROM TableName [as NewName] 
[{INNER | LEFT OUTER | FULL } 
JOIN Table2 as [as NewName] ON condition], 

где condition - любой предикат

[WHERE condition]
[GROUP BY columnList] [HAVING condition]
[ORDER BY columnList [ASC | DESC]]

FROM -> [JOIN ON] 
-> [WHERE] -> [GROUP BY]
-> [HAVING] -> [SELECT] 
-> [DISTINCT] -> [ORDER BY] 
- последовательность выполнения
```

## Как разворачивается JOIN?

``` py
for v in R
    for s in S
        if r.attr = s.attr
            print(r+s)
```

```py
R.sort(attr)
S.sort(attr)

while not EndOf(S) and EndOf(R):
    if (r.attr < s.attr):
        next(R)
    if (r.attr == s.attr):
        print(r + s)
    if (r.attr > s.attr):
        next(S)
```